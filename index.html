<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Ù…Ø­Ø§Ø³Ø¨Ø© WiFi (Ù…Ø¨Ø³Ù‘Ø·)</title>
  <style>
    body{font-family:Tahoma,Arial;background:#f5f7fb;margin:0;padding:14px}
    .box{max-width:900px;margin:auto;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:14px}
    h1{margin:0 0 10px;font-size:18px}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .f{flex:1;min-width:160px}
    label{display:block;font-size:12px;color:#6b7280;margin:8px 0 5px}
    input,select{width:100%;padding:10px;border:1px solid #e5e7eb;border-radius:10px;font-size:13px}
    button{padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#111827;color:#fff;cursor:pointer}
    button.gray{background:#fff;color:#111827}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border-bottom:1px solid #eee;padding:10px;text-align:right;font-size:13px;vertical-align:top}
    th{background:#f9fafb}
    .muted{color:#6b7280;font-size:12px}
    .bad{color:#dc2626;font-weight:700}
    .ok{color:#16a34a;font-weight:700}
    .right{display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap}
  </style>
</head>
<body>
  <div class="box">
    <h1>Ù…Ø­Ø§Ø³Ø¨Ø© WiFi (Ù…Ø¨Ø³Ù‘Ø·)</h1>
    <div class="muted">Ø¹Ù…Ù„Ø§Ø¡ + Ø§Ø´ØªØ±Ø§Ùƒ Ø´Ù‡Ø±ÙŠ + Ø¯ÙØ¹Ø§Øª + Ù…ØªØ¨Ù‚ÙŠ (Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ)</div>

    <div class="row">
      <div class="f">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
        <input id="name" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø¨Ùˆ Ø£Ø­Ù…Ø¯">
      </div>
      <div class="f">
        <label>Ø§Ù„Ù‡Ø§ØªÙ</label>
        <input id="phone" placeholder="70503468">
      </div>
      <div class="f">
        <label>Ø³Ø¹Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ</label>
        <input id="fee" type="number" step="0.01" placeholder="Ù…Ø«Ø§Ù„: 10">
      </div>
    </div>

    <div class="row">
      <div class="f">
        <label>ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø±</label>
        <input id="month" type="month">
      </div>
      <div class="f">
        <label>Ø§Ù„Ø¯ÙØ¹Ø©</label>
        <input id="pay" type="number" step="0.01" placeholder="Ù…Ø«Ø§Ù„: 5">
      </div>
      <div class="f">
        <label>Ù…Ù„Ø§Ø­Ø¸Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <input id="note" placeholder="Ù…Ø«Ø§Ù„: Ø¯ÙØ¹ Ù†Øµ">
      </div>
    </div>

    <div class="right" style="margin-top:10px">
      <button onclick="add()">â• Ø­ÙØ¸ / Ø¥Ø¶Ø§ÙØ©</button>
      <button class="gray" onclick="clearForm()">Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
      <button class="gray" onclick="wipe()">ØªØµÙÙŠØ± ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <div style="overflow:auto">
      <table>
        <thead>
          <tr>
            <th>Ø§Ù„Ø´Ù‡Ø±</th>
            <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
            <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
            <th>Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
            <th>Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th>
            <th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
            <th>Ù…Ù„Ø§Ø­Ø¸Ø©</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="tbl"></tbody>
      </table>
    </div>

    <div class="muted" id="sum" style="margin-top:10px"></div>
  </div>

<script>
  const KEY="wifi_simple_v1";
  let rows = [];

  const $ = id => document.getElementById(id);
  const nowMonth = () => new Date().toISOString().slice(0,7);

  function load(){
    try{ rows = JSON.parse(localStorage.getItem(KEY) || "[]"); }catch(e){ rows=[]; }
    if(!$("month").value) $("month").value = nowMonth();
    render();
  }
  function save(){ localStorage.setItem(KEY, JSON.stringify(rows)); }

  function n(x){ x=Number(x||0); return isFinite(x)?x:0; }
  function money(x){ return n(x).toFixed(2); }

  function clearForm(){
    $("name").value=""; $("phone").value=""; $("fee").value="";
    $("pay").value=""; $("note").value="";
    if(!$("month").value) $("month").value = nowMonth();
  }

  function add(){
    const name = $("name").value.trim();
    const phone = $("phone").value.trim();
    const fee = n($("fee").value);
    const month = $("month").value || nowMonth();
    const pay = n($("pay").value);
    const note = $("note").value.trim();

    if(!name || !phone || fee<=0){ alert("Ø¨Ø¯Ù‘ÙŠ Ø§Ø³Ù… + Ù‡Ø§ØªÙ + Ø§Ø´ØªØ±Ø§Ùƒ ØµØ­ÙŠØ­"); return; }

    // Ø¥Ø°Ø§ Ù†ÙØ³ Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆÙ†ÙØ³ Ø§Ù„Ø´Ù‡Ø± Ù…ÙˆØ¬ÙˆØ¯: Ù†Ø¬Ù…Ø¹ Ø§Ù„Ø¯ÙØ¹Ø© ÙˆÙ†Ø­Ø¯Ù‘Ø« Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ/Ù…Ù„Ø§Ø­Ø¸Ø©
    const idx = rows.findIndex(r => r.name===name && r.phone===phone && r.month===month);
    if(idx>=0){
      rows[idx].fee = fee;
      rows[idx].paid = n(rows[idx].paid) + pay;
      rows[idx].note = note || rows[idx].note;
    }else{
      rows.unshift({ id: crypto.randomUUID?.() || (Date.now()+""), month, name, phone, fee, paid: pay, note });
    }

    save(); render();
    $("pay").value=""; $("note").value="";
  }

  function del(id){
    if(!confirm("Ø­Ø°ÙØŸ")) return;
    rows = rows.filter(r=>r.id!==id);
    save(); render();
  }

  function wipe(){
    if(!confirm("Ø£ÙƒÙŠØ¯ ØªØµÙÙŠØ± ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")) return;
    rows=[]; save(); render();
  }

  function render(){
    const tb = $("tbl");
    if(!rows.length){
      tb.innerHTML = `<tr><td colspan="8" class="muted">Ù…Ø§ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯.</td></tr>`;
      $("sum").textContent="";
      return;
    }

    let totalFee=0, totalPaid=0, totalBal=0;

    tb.innerHTML = rows.map(r=>{
      const bal = n(r.fee) - n(r.paid);
      totalFee += n(r.fee);
      totalPaid += n(r.paid);
      totalBal += bal;

      return `
        <tr>
          <td>${r.month}</td>
          <td><b>${r.name}</b></td>
          <td>${r.phone}</td>
          <td>${money(r.fee)}</td>
          <td>${money(r.paid)}</td>
          <td class="${bal>0?'bad':'ok'}">${money(bal)}</td>
          <td class="muted">${r.note||""}</td>
          <td><button class="gray" onclick="del('${r.id}')">ğŸ—‘ï¸</button></td>
        </tr>
      `;
    }).join("");

    $("sum").textContent =
      `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: ${money(totalFee)} | Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹: ${money(totalPaid)} | Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${money(totalBal)}`;
  }

  load();
</script>
</body>
</html>